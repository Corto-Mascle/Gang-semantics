\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{todonotes}
\usepackage[notion, quotation, silent]{knowledge}
%remove silent to have knowledge warnings
\usepackage{extarrows}
\usepackage[normalem]{ulem}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{xspace}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{booktabs}
%\usepackage{array}
%\usepackage{changepage}
\usepackage{enumitem}
\usepackage[capitalise]{cleveref}
\usepackage{cite}
\usepackage{multidef}
\usepackage{xspace}
\usepackage{mathrsfs}


\usetikzlibrary{arrows,calc,automata,fit,shapes,positioning}
\tikzset{AUT style/.style={>=angle 60,initial text= ,every edge/.append,every state/.style={minimum size=20,inner sep=2}}}


%\newenvironment{proofsketch}{\noindent\emph{Proof sketch.}}{\hfill$\square$}

\makeatletter
\def\namedlabel#1#2{\begingroup
	\def\@currentlabel{#2}%
	\label{#1}\endgroup
}
\makeatother

%%% Basic Math

\newcommand{\nats}{\mathbb{N}}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\powerset}[1]{2^{#1}}
\newcommand{\step}[1]{\xrightarrow{#1}}
\newcommand{\extlabel}[2]{\mathsf{ext}(#1,#2)} % message type + value
\newcommand{\intlabel}[1]{\mathsf{int}(#1)}
\newcommand{\locallabel}{\lambda} % variable name for something that may either be a \extlabel or a \intlabel
\newcommand{\extbr}[2]{\xrightarrow{\extlabel{#1}{#2}}}
\newcommand{\intstep}[1]{\xrightarrow{\intlabel{#1}}}
\newcommand{\size}[1]{|#1|}
\newcommand{\length}[1]{\mathsf{len}(#1)}
\newcommand{\nset}[2]{[#1,#2]} %interval of natural numbers
%%% Complexity classes

% \newcommand{\poly}{\text{\sc{P}}\xspace}
% \newcommand{\conp}{\textsc{coNP}\xspace}
% \newcommand{\pspace}{\text{\sc{PSpace}}\xspace}
% \newcommand{\expt}{\textsc{ExpTime}\xspace}
% \newcommand{\nexpt}{\textsc{NExpTime}\xspace}
% \newcommand{\exps}{\textsc{ExpSpace}\xspace}
\multidef{\text{\sc{#1}}\xspace}{co,coNP,NP,PSPACE,coPSPACE,NPSPACE,PTIME,EXPTIME,EXPSPACE,NEXPTIME, LOGSPACE, TOWER, BNRA}
\newcommand{\Fcomplexity}[1]{\mathbf{F}_{#1}} % the Falpha complexity class
\newcommand{\Fomegaomega}{\Fcomplexity{\omega^{\omega}}}
\newcommand{\Ffunction}[1]{\mathscr{F}_{#1}}
\newcommand{\COVER}{\textsc{"Cover"}\xspace}

%%% Genral definition
\newcommand{\prot}{\mathcal{P}} %protocol
\newcommand{\transitions}{\Delta} % transitions
\newcommand{\atrans}{\delta}

% greek letters
\renewcommand{\a}{\alpha}
\newcommand{\config}{\gamma}
\renewcommand{\epsilon}{\varepsilon}


%%% BNRA syntax

\newcommand{\brone}[1]{\textbf{br}(#1)}
% for reception, first argument is message type and second is operation made with the register
\newcommand{\recone}[2]{\textbf{rec}(#1, #2)}

\newcommand{\br}[2]{\textbf{br}(#1, #2)}
% for reception, first argument is message type and second is operation made with the register
\newcommand{\rec}[3]{\textbf{rec}(#1, #2, #3)}
\newcommand{\loc}[3]{\textbf{loc}(#1,#2,#3)}
\newcommand{\recmulti}[2]{\textbf{rec}(#1, #2)}
\newcommand{\brsymb}{\textbf{br}}
\newcommand{\recsymb}{\textbf{rec}}
\newcommand{\locsymb}{\textbf{loc}}

\newcommand{\actions}{\mathsf{Actions}}
\newcommand{\anact}{\alpha}
\newcommand{\enregact}{\downarrow}
\newcommand{\dummyact}{{*}}
\newcommand{\diseqtestact}{{\ne}}
\newcommand{\eqtestact}{{=}}

%quotes in math mode
\DeclareMathSymbol{\mlq}{\mathord}{operators}{``}
\DeclareMathSymbol{\mrq}{\mathord}{operators}{`'}
\newcommand{\quotemarks}[1]{\mlq #1 \mrq}


% projection of a configuration on state part and register part
\renewcommand{\st}[1]{\mathsf{st}(#1)}
\newcommand{\data}[1]{\mathsf{data}(#1)}

% a register value
\newcommand{\aval}{v}
\newcommand{\avalbr}{v_{\brsymb}}
%messages
\newcommand{\messages}{\mathcal{M}}
\newcommand{\amessage}{m}
\newcommand{\wordproj}[2]{\pi_{#2}(#1)}
\newcommand{\regnum}{r}
\newcommand{\operations}{\mathsf{Op}}
\newcommand{\op}{\mathsf{op}}

%font for variables in queries
\newcommand{\var}[1]{\mathsf{#1}}
\newcommand{\varz}{\var{z}}
\newcommand{\varset}{\mathsf{Var}}

\newcommand{\query}{\phi}

\newcommand{\apath}{\pi} % hoping that this does not beak anything
\newcommand{\run}{\rho}
% \newcommand{\Runs}[1]{Runs_{#1}}
\newcommand{\runsize}[1]{||#1||}
\newcommand{\agents}{\mathbb{A}}
\knowledgenewrobustcmd{\statesin}[1]{\mathsf{\cmdkl{cov}}\cmdkl{(}#1\cmdkl{)}}
\knowledgenewrobustcmd{\valsof}[1]{\mathsf{\cmdkl{val}}\cmdkl{(}#1\cmdkl{)}}
\knowledgenewrobustcmd{\agentsof}[1]{\mathsf{\cmdkl{ag}}\cmdkl{(}#1\cmdkl{)}}

\newcommand{\allconfigs}{\Gamma}

\knowledgenewrobustcmd{\lessthan}{~\cmdkl{\trianglelefteq}~}

% gangs
\newcommand{\boss}{\mathsf{b}}
\newcommand{\clique}{\mathsf{K}}
\newcommand{\gang}{\mathsf{G}}
\newcommand{\gangset}{\mathcal{G}}
\newcommand{\gangconfigs}{\mathcal{G}}
\knowledgenewrobustcmd{\gangof}[2]{\mathsf{\cmdkl{gang}}_{#1}\cmdkl{(}#2\cmdkl{)}}
\newcommand{\noboss}{\bot}

% abstract semantics
\newcommand{\covset}{S}
\newcommand{\aconfig}{\sigma}
\newcommand{\aconfigs}[1]{\Sigma_{#1}}
\newcommand{\allaconfigs}{\Sigma}
\newcommand{\aconfiginit}{\aconfig_0}
\newcommand{\aconfiginitset}{\allaconfigs_{\mathsf{init}}}
\newcommand{\arun}{\nu}

\knowledgenewrobustcmd{\absproj}[2]{\cmdkl{\mathsf{abs}}_{#1}\cmdkl{(}#2\cmdkl{)}}

% some standard names useful in proofs
\newcommand{\agentbr}{a_{\brsymb}} %agent broadcasting
\newcommand{\agentboss}{a_{\mathsf{boss}}}
\newcommand{\statebr}{q_{\brsymb}}


% 

\newcommand{\val}{v}
\newcommand{\trace}[1]{\mathsf{tr}(#1)}
\newcommand{\Input}[1]{\mathsf{In}(#1)}
\newcommand{\vinput}[2]{\mathsf{In}_{#1}(#2)}
\newcommand{\Output}[1]{\mathsf{Out}(#1)}
\newcommand{\voutput}[2]{\mathsf{Out}_{#1}(#2)}
\newcommand{\vproj}[2]{{#2}|_{#1}}

\newcommand{\inputword}{in}
\newcommand{\Outputword}{out}


\newcommand{\decsymb}{\mathtt{dec}}
\newcommand{\subdec}{\unlhd}
\newcommand{\langdec}[1]{\mathcal{L}^{\mathtt{#1}}}

\newcommand{\tree}{\tau}
\newcommand{\node}{\mu}

\newcommand{\localrunlabel}[1]{\mathbf{lr}(#1)}
\newcommand{\valuelabel}[1]{\mathbf{val}(#1)}
\newcommand{\bosslabel}[1]{\mathbf{bw}(#1)}
\newcommand{\followlabelword}[1]{\mathbf{fw}(#1)}
\newcommand{\followlabelmessage}[1]{\mathbf{fm}(#1)}
\newcommand{\speclabel}[1]{\mathbf{spec}(#1)}
\newcommand{\spec}{\mathsf{spec}}
\newcommand{\bossspec}{\mathsf{bw}}
\newcommand{\followwordspec}{\mathsf{fw}}
\newcommand{\followmessagespec}{\mathsf{fm}}



%Target problem
\newcommand{\TARGET}{\textsc{"Target"}\xspace}
\newcommand{\Loc}{\text{Loc}}
\newcommand{\cpt}{\ensuremath{\mathtt{x}}}
\newcommand{\Cpt}{\ensuremath{\mathtt{X}}}
\newcommand{\dec}[1]{\ensuremath{\mathtt{#1}-}}
\newcommand{\inc}[1]{\ensuremath{\mathtt{#1}+}}
\newcommand{\testz}[1]{\ensuremath{\mathtt{#1}=0}}
\newcommand{\stepMM}[1]{\xrightarrow{#1}}
\newcommand{\altitude}[1]{\mathbf{alt}(#1)}
\newcommand{\altmax}{\mathbf{altmax}}
\newcommand{\altmin}{\mathbf{altmin}}


%local stuff
\newcommand{\localrun}{u}
\newcommand{\localdata}{\nu}

%partial runs

\newcommand{\pstep}[1]{\step{#1}_{p}}
\newcommand{\inttest}{\pstep{\locsymb}}
\newcommand{\intmessage}[2]{\pstep{\brsymb, #1, #2}}
\newcommand{\extmessage}[2]{\pstep{\recsymb, #1, #2}}
	
%bounding functions
\newcommand{\towerfun}{\psi}
\newcommand{\repexp}[2]{\mathsf{repexp}(#1,#2)}
\newcommand{\Vinit}{W}

\newcommand{\subword}{\preceq}
\newcommand{\supword}{\succeq}

\newcommand{\binrel}[3]{#1 \mathrel{#2} #3}

\newcommand{\los}{\mathcal{L}}
\newcommand{\lstep}[1]{\xrightarrow{#1}_{\los}}

\newcommand{\lstates}{L}
\newcommand{\lstate}{l}
\newcommand{\ltrans}{d}
\newcommand{\ltransitions}{D}
\newcommand{\startstate}[1]{\mathbf{start}(#1)}
\newcommand{\transstateone}[1]{\mathbf{tr}_1(#1)}
\newcommand{\transstatetwo}[1]{\mathbf{tr}_2(#1)}
\newcommand{\finstate}[1]{\mathbf{end}(#1)} %final states of protocol for encoding of LCS, argument is corresponding state of the LCS
\newcommand{\waitstate}{\mathbf{wait}}
\newcommand{\predfun}{\mathbf{pred}}

%a trace
\newcommand{\atrace}{tr}

%elimination of equality
\newcommand{\map}{\mathsf{map}}
\newcommand{\idmap}{\mathsf{id}}
\knowledgenewrobustcmd{\memoryproj}[1]{\cmdkl{\mathsf{mem}}(#1)}
\knowledgenewrobustcmd\perfproj[1]{\cmdkl{\mathsf{perf}}(#1)}

\newcommand{\tuple}[1]{\langle #1 \rangle}