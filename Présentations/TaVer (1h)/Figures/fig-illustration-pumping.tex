

	\begin{tikzpicture}[>=triangle 45]
%		\draw[white,fill=gray!20] (2,0) rectangle (3,0.8);
%		\draw[white,fill=gray!20] (2,1.3) rectangle (3,2.5);
%		
%		\draw (0,0) rectangle (5,2.5);
%		
%		\draw (0,0.8) rectangle (5,1.3);
%		
%		\draw (0,0.8) rectangle (0.3,1.3);
%		\draw (0,0.8) rectangle (1.3,1.3);
%		\draw[fill=red!20] (1.3,0.8) rectangle (4,1.3);
%		
%		\draw[dotted] (2,0) -- (2,2.5);
%		\draw[dotted] (3,0) -- (3,2.5);
%		
%		
%		
%		\draw (0,-3) rectangle (4,-0.5);
%		
%		\draw (0,-2.2) rectangle (4,-1.7);
%		
%		\draw (0,-2.2) rectangle (0.3,-1.7);
%		\draw (0.3,-2.2) rectangle (1.3,-1.7);
%		\draw[fill=red!20] (1.2,-2.2) rectangle (2.8,-1.7);
%		
%		\draw[dotted] (2,-3) -- (2,-0.5);
%		
%		\draw (5.4,-3) -- (5.4,3);
		
		\onslide<2-4> {\node (txt) at (6.5,4) {0 active registers};}
		\onslide<5-10> {\node (txt) at (6.5,4) {1 active registers};}
		\onslide<11-> {\node (txt) at (6.5,4) {n active registers};
		\node (txt) at (11,3.2) {Say we can reduce any local run with $<n$ active registers of length $\geq K$.};
		}
		
		
		\node (q) at (5.5,2.5) {$q$};
		\node (v1) at (5.5,1.75) {$v_1$};
		\node (v2) at (5.5,1.25) {$v_2$};
		\node (v3) at (5.5,0.75) {$v_3$};
		\node (v4) at (5.5,0.25) {$v_4$};
		
		\onslide<1-3,5-6,8-9, 11-12>
		{
		\node (q') at (15.5,2.5) {$q'$};
		\node (v'1) at (15.5,1.75) {$v'_1$};
		\node (v'2) at (15.5,1.25) {$v'_2$};
		\node (v'3) at (15.5,0.75) {$v'_3$};
		\node (v'4) at (15.5,0.25) {$v'_4$};
	}
	
	\onslide<1>
	{
		\draw (6,0) rectangle (7.5,0.5);
		\draw (6,0.5) rectangle (9.3,1);
		\draw (6,1) rectangle (7.2,1.5);
		\draw (6,1.5) rectangle (8.2,2);
		
		\draw (6,0) rectangle (10.4,0.5);
		\draw (6,0.5) rectangle (11.6,1);
		\draw (6,1) rectangle (10,1.5);
		\draw (6,1.5) rectangle (11.2,2);
		
		\draw (6,0) rectangle (12.5,0.5);
		\draw (6,0.5) rectangle (14.3,1);
		\draw (6,1) rectangle (12.2,1.5);
		\draw (6,1.5) rectangle (13.2,2);
	}
	
	\onslide<1-3>
	{
	
	\draw (6,0) rectangle (15,0.5);
	\draw (6,0) rectangle (15,1);
	\draw (6,0) rectangle (15,1.5);
	\draw (6,0) rectangle (15,2);
	
	
	}
	
	\onslide<3>
	{
		
		\draw[dashed] (9,-0.2) -- (9,2.2);
		\draw[dashed] (12,-0.2) -- (12,2.2);
		
		\node (s) at (9, 2.4) {$q''$};
		\node (s) at (12, 2.4) {$q''$};
	}
	
	\onslide<4>
	{
		
		\draw[dashed] (9,-0.2) -- (9,2.2);
		
		\node (s) at (9, 2.4) {$q''$};
		
		\draw (6,0) rectangle (12,0.5);
		\draw (6,0) rectangle (12,1);
		\draw (6,0) rectangle (12,1.5);
		\draw (6,0) rectangle (12,2);
		
		
		\node (q') at (12.5,2.5) {$q'$};
		\node (v'1) at (12.5,1.75) {$v'_1$};
		\node (v'2) at (12.5,1.25) {$v'_2$};
		\node (v'3) at (12.5,0.75) {$v'_3$};
		\node (v'4) at (12.5,0.25) {$v'_4$};
	}
	
	
	
	
		
		\onslide<5>
		{
			
		
		\draw[white,fill=red!20] (8.3, 0) rectangle (11.1,2);	
			
			\draw (6,1.5) rectangle (11.2,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			\draw (6,1.5) rectangle (13.2,2);
		
			
			
			\draw (6,0) rectangle (15,0.5);
			\draw (6,0) rectangle (15,1);
			\draw (6,0) rectangle (15,1.5);
			\draw (6,0) rectangle (15,2);
			
			\draw[<->] (8.3, -0.2) -- (11.1,-0.2);
			\node (d) at (9.7,-0.5) {$>|Q|$};
		}
		
				\onslide<6>
		{
			
			
			\draw[white,fill=red!20] (8.3, 0) rectangle (11.1,2);	
			
			\draw (6,1.5) rectangle (11.2,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			\draw (6,1.5) rectangle (13.2,2);
			
			
			
			\draw (6,0) rectangle (15,0.5);
			\draw (6,0) rectangle (15,1);
			\draw (6,0) rectangle (15,1.5);
			\draw (6,0) rectangle (15,2);
			
			\draw[<->] (8.3, -0.2) -- (11.1,-0.2);
			\node (d) at (9.7,-0.5) {$>|Q|$};
			
			
			\draw[dashed] (9,-0.2) -- (9,2.2);
			\draw[dashed] (10.5,-0.2) -- (10.5,2.2);
			
			\node (s) at (9, 2.4) {$q''$};
			\node (s) at (10.5, 2.4) {$q''$};
		}
		
		\onslide<7>
		{
			
			
			\draw[white,fill=red!20] (8.3, 0) rectangle (9.6,2);	
			
			\draw (6,1.5) rectangle (9.7,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			\draw (6,1.5) rectangle (11.7,2);
			
			
			
			\draw (6,0) rectangle (13.5,0.5);
			\draw (6,0) rectangle (13.5,1);
			\draw (6,0) rectangle (13.5,1.5);
			\draw (6,0) rectangle (13.5,2);
			
			
			\node (q') at (14,2.5) {$q'$};
			\node (v'1) at (14,1.75) {$v'_1$};
			\node (v'2) at (14,1.25) {$v'_2$};
			\node (v'3) at (14,0.75) {$v'_3$};
			\node (v'4) at (14,0.25) {$v'_4$};
			
			
			
			\draw[dashed] (9,-0.2) -- (9,2.2);
			
			\node (s) at (9, 2.4) {$q''$};
		}
		
								\onslide<8>
		{
			
			
			%			\draw[white,fill=red!20] (8.3, 0) rectangle (11.1,2);	
			
			\draw (6,1.5) rectangle (11.2,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			
			\draw (6,1.5) rectangle (6.9,2);
			
			\draw (6,1.5) rectangle (12,2);
			
			\draw (6,1.5) rectangle (9.9,2);
			
			\draw (6,1.5) rectangle (13.2,2);
			
			
			\draw (6,1.5) rectangle (8.9,2);
			
			\draw (6,0) rectangle (15,0.5);
			\draw (6,0) rectangle (15,1);
			\draw (6,0) rectangle (15,1.5);
			\draw (6,0) rectangle (15,2);
			
			\draw[<->] (6, -0.2) -- (15,-0.2);
			\node (d) at (10.5,-0.5) {$>|Q|(|Q|+1)$};
			
			
%			\draw[dashed] (6.9,-0.1) -- (6.9,2.2);
%			\draw[dashed] (9.9,-0.1) -- (9.9,2.2);
%			
%			\node (s) at (6.9, 2.4) {$q''$};
%			\node (s) at (9.9, 2.4) {$q''$};
		}
		
		
						\onslide<9>
		{
			
			
			\draw[white,fill=blue!20] (6, 1.5) rectangle (6.9,2);	
			\draw[white,fill=blue!50] (6.9, 1.5) rectangle (8.2,2);
			
			\draw[white,fill=green!20] (8.9, 1.5) rectangle (9.9,2);	
			\draw[white,fill=green!40] (9.9, 1.5) rectangle (11.2,2);
			
			\draw (6,1.5) rectangle (11.2,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			
			\draw (6,1.5) rectangle (6.9,2);
			
			\draw (6,1.5) rectangle (12,2);
			
			\draw (6,1.5) rectangle (9.9,2);
			
			\draw (6,1.5) rectangle (13.2,2);
			
			\draw (6,1.5) rectangle (8.9,2);
			
			
			\draw (6,0) rectangle (15,0.5);
			\draw (6,0) rectangle (15,1);
			\draw (6,0) rectangle (15,1.5);
			\draw (6,0) rectangle (15,2);
			
			\draw[<->] (6, -0.2) -- (15,-0.2);
			\node (d) at (10.5,-0.5) {$>|Q|(|Q|+1)$};
			
			
			\draw[dashed] (6.9,-0.1) -- (6.9,2.2);
			\draw[dashed] (9.9,-0.1) -- (9.9,2.2);
			
			\node (s) at (6.9, 2.4) {$q''$};
			\node (s) at (9.9, 2.4) {$q''$};
		}
		
								\onslide<10>
		{
			\draw[white,fill=blue!20] (6, 1.5) rectangle (6.9,2);	
			
			\draw[white,fill=green!40] (6.9, 1.5) rectangle (8.2,2);
			
			\draw (6,1.5) rectangle (8.2,2);
			
			
			\draw (6,1.5) rectangle (6.9,2);
			
			\draw (6,1.5) rectangle (9,2);
			
			\draw (6,1.5) rectangle (10.2,2);
			
			
			\draw (6,0) rectangle (12,0.5);
			\draw (6,0) rectangle (12,1);
			\draw (6,0) rectangle (12,1.5);
			\draw (6,0) rectangle (12,2);
			
			\node (q') at (13,2.5) {$q'$};
			\node (v'1) at (13,1.75) {$v'_1$};
			\node (v'2) at (13,1.25) {$v'_2$};
			\node (v'3) at (13,0.75) {$v'_3$};
			\node (v'4) at (13,0.25) {$v'_4$};
			
			\draw[dashed] (6.9,-0.1) -- (6.9,2.2);
			
			\node (s) at (6.9, 2.4) {$q''$};
		}
		
		
		\onslide<11>
		{
			
			\draw[white, fill=red!20] (7.7,0) rectangle (10.7,2);
			\draw[white, fill=red!40] (7.7,0) rectangle (10.7,0.5);
				
			\draw (6,0) rectangle (15,0.5);
			\draw (6,0) rectangle (15,1);
			\draw (6,0) rectangle (15,1.5);
			\draw (6,0) rectangle (15,2);
			
			\draw (6,0) rectangle (7.5,0.5);
			\draw (6,0.5) rectangle (8.8,1);
			\draw (6,1) rectangle (7.2,1.5);
			\draw (6,1.5) rectangle (8.2,2);
			
			\draw (6,0.5) rectangle (11.6,1);
			\draw (6,1) rectangle (10,1.5);
			\draw (6,1.5) rectangle (11.2,2);
			
			\draw (6,0) rectangle (12.5,0.5);
			\draw (6,0.5) rectangle (13.8,1);
			\draw (6,1) rectangle (12.2,1.5);
			\draw (6,1.5) rectangle (13.2,2);
			
			
			\draw[<->] (7.7, -0.2) -- (10.7,-0.2);
			\node (d) at (9.2,-0.5) {$K$};
		}
		
		
		
		
		\onslide<12>
		{
			
		\draw[white, fill=blue!20] (7,0) rectangle (9.5,2);
		\draw[white, fill=green!20] (12,0) rectangle (14.5,2);
			
		\draw (6,0) rectangle (15,0.5);
		\draw (6,0) rectangle (15,1);
		\draw (6,0) rectangle (15,1.5);
		\draw (6,0) rectangle (15,2);
		
		\draw (6,0) rectangle (7.5,0.5);
		\draw (6,0.5) rectangle (8.8,1);
		\draw (6,1) rectangle (7.2,1.5);
		\draw (6,1.5) rectangle (8.2,2);
		
		\draw (6,0) rectangle (10.4,0.5);
		\draw (6,0.5) rectangle (11.6,1);
		\draw (6,1) rectangle (10,1.5);
		\draw (6,1.5) rectangle (11.2,2);
		
		\draw (6,0) rectangle (12.5,0.5);
		\draw (6,0.5) rectangle (13.8,1);
		\draw (6,1) rectangle (12.2,1.5);
		\draw (6,1.5) rectangle (13.2,2);
		
		\draw[<->] (12, -0.2) -- (14.5,-0.2);
		\node (d) at (13.25,-0.5) {$K$};
		
		\draw[<->] (7, -0.2) -- (9.5,-0.2);
		\node (d) at (8.25,-0.5) {$K$};
		
		\draw[<->] (6, -0.7) -- (15,-0.7);
		\node (d) at (10.5,-1) {$> |\Delta|^K$};
		}
		
				\onslide<13>
		{
			
			\draw[white, fill=blue!20] (7,0) rectangle (7.5,0.5);
			\draw[white, fill=blue!20] (7,0.5) rectangle (8.8,1);
			\draw[white, fill=blue!20] (7,1) rectangle (7.2,1.5);
			\draw[white, fill=blue!20] (7,1.5) rectangle (8.2,2);
			
			
			\draw[white, fill=green!20] (7.5,0) rectangle (9.5,0.5);
			\draw[white, fill=green!20] (8.8,0.5) rectangle (9.5,1);
			\draw[white, fill=green!20] (7.2,1) rectangle (9.5,1.5);
			\draw[white, fill=green!20] (8.2,1.5) rectangle (9.5,2);
			
			
			\draw (6,0) rectangle (10,0.5);
			\draw (6,0) rectangle (10,1);
			\draw (6,0) rectangle (10,1.5);
			\draw (6,0) rectangle (10,2);
			
			
			\draw[<->] (7, -0.2) -- (9.5,-0.2);
			\node (d) at (8.25,-0.5) {$K$};
			
			\draw (6,0) rectangle (7.5,0.5);
			\draw (6,0.5) rectangle (8.8,1);
			\draw (6,1) rectangle (7.2,1.5);
			\draw (6,1.5) rectangle (8.2,2);
			
			\node (q') at (10.5,2.5) {$q'$};
			\node (v'1) at (10.5,1.75) {$v'_1$};
			\node (v'2) at (10.5,1.25) {$v'_2$};
			\node (v'3) at (10.5,0.75) {$v'_3$};
			\node (v'4) at (10.5,0.25) {$v'_4$};
		
		}
		
		
	\end{tikzpicture}

